---
import { Image } from "astro:assets";
import cama from "../../assets/pay/cama.webp";
import area from "../../assets/pay/m2.webp";

interface Section {
  image: string;
  text: string;
  people: string;
  bed: string;
  area: string;
  alt: string;
}

const rooms = import.meta.glob<{ default: ImageMetadata }>(
  '../../assets/rooms/*.webp',
  { eager: true }
);

const currentLocale = Astro.currentLocale || 'es';

const roomsEs = import.meta.glob<any>('../../content/rooms-info.md', { eager: true });
const roomsEn = import.meta.glob<any>('../../content/rooms-info-en.md', { eager: true });

const roomsData = currentLocale === 'en'
  ? Object.values(roomsEn)[0]
  : Object.values(roomsEs)[0];

const { frontmatter } = roomsData;
const sections = frontmatter.sections as Section[];

function getImage(path: string): ImageMetadata {
  const filename = path.split('/').pop();
  const key = `../../assets/rooms/${filename}`;
  return rooms[key]?.default;
}

const translations = {
  es: {
    people: "Personas",
    labels: { area: "m2", bed: "" }
  },
  en: {
    people: "People",
    labels: { area: "m2", bed: "" }
  }
};

const t = translations[currentLocale as keyof typeof translations];
---

<div class="card-container max-md:grid-cols-2 max-sm:grid-cols-1 grid grid-cols-3 justify-center items-center gap-[10px] flex-wrap p-[40px]">
  {sections.map((section) => (
    <div class="border-[1px] max-sm:h-full max-lg:h-[23em] max-md:w-[100%] border-gray-300 p-[15px]">
      <div>
        <Image
          width={440}
          height={320}
          src={getImage(section.image)}
          alt={section.alt}
          loading="lazy"
        />
      </div>
      <div>
        <h2 class="title text-2xl text-gray-700 font-normal pt-[10px]">{section.text}</h2>
        <div>
          <ul class="flex flex-col gap-[10px] pt-[10px] text-gray-600">
            <li class="items flex items-center gap-[15px]">
              <i class="text-[#F7A40F] icon-card bi bi-people-fill" />
              {section.people} {t.people}
            </li>
            <li class="items flex items-center gap-[15px]">
              <Image class="w-[20px]" loading="eager" src={area} alt="image-area" />
              {section.area}
            </li>
            <li class="items flex items-center gap-[15px]">
              <Image class="w-[20px]" loading="eager" src={cama} alt="image-bed" />
              {section.bed}
            </li>
          </ul>
        </div>
      </div>
    </div>
  ))}
</div>