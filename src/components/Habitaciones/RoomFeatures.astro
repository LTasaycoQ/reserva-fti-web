---
import AdditionalDetails from "./AdditionalDetails.astro";
---

<section class="text-center">
    <div class="position__title flex flex-col  justify-center items-center">
        <h1 class="title text-gray-700 text-[1.9rem] mb-4">
            CARACTERISTICAS DE LAS HABITACIONES
        </h1>
        <span class="w-[250px] bg-[#F6A818] relative top-[-8px]  h-[1px]"></span>
    </div>

    <AdditionalDetails/>
</section>
<style>
    .position__title{
        margin-top: 40px;
        margin-bottom: 50px;
    }
</style>


<script type="module">


document.addEventListener("DOMContentLoaded", () => {
    const sliders = document.querySelectorAll(".slider__rooms");

    sliders.forEach((slider) => {
        const prevBtn = slider.parentElement.querySelector(".prevBtn");
        const nextBtn = slider.parentElement.querySelector(".nextBtn");
        const images = Array.from(slider.children);

        const firstClone = images[0].cloneNode(true);
        const lastClone = images[images.length - 1].cloneNode(true);

        slider.appendChild(firstClone);
        slider.insertBefore(lastClone, slider.firstChild);

        let currentIndex = 1;
        const totalSlides = images.length;

        const updateSlider = (smooth = true) => {
            const imageWidth = images[0].offsetWidth + 20;
            slider.style.scrollBehavior = smooth ? 'smooth' : 'auto';
            slider.scrollLeft = currentIndex * imageWidth;
        };

        updateSlider(false);

        nextBtn.addEventListener("click", () => {
            currentIndex++;
            updateSlider(true);
        });

        prevBtn.addEventListener("click", () => {
            currentIndex--;
            updateSlider(true);
        });

        slider.addEventListener("scrollend", () => {
            if (currentIndex === 0) {
                currentIndex = totalSlides;
                updateSlider(false);
            } else if (currentIndex === totalSlides + 1) {
                currentIndex = 1;
                updateSlider(false);
            }
        });

        let isDragging = false;
        let startX, startScrollLeft;

        slider.addEventListener("mousedown", (e) => {
            isDragging = true;
            slider.style.cursor = 'grabbing';
            slider.style.scrollBehavior = 'auto';
            startX = e.pageX;
            startScrollLeft = slider.scrollLeft;
        });

        slider.addEventListener("mousemove", (e) => {
            if (!isDragging) return;
            e.preventDefault();
            const x = e.pageX;
            const walk = (startX - x) * 1.5;
            slider.scrollLeft = startScrollLeft + walk;
        });

        const stopDragging = () => {
            if (!isDragging) return;
            isDragging = false;
            slider.style.cursor = 'grab';

            const imageWidth = images[0].offsetWidth + 20;
            currentIndex = Math.round(slider.scrollLeft / imageWidth);
            updateSlider(true);
        };

        slider.addEventListener("mouseup", stopDragging);
        slider.addEventListener("mouseleave", stopDragging);

        slider.addEventListener("touchstart", (e) => {
            startX = e.touches[0].pageX;
            startScrollLeft = slider.scrollLeft;
        });

        slider.addEventListener("touchmove", (e) => {
            const x = e.touches[0].pageX;
            const walk = (startX - x) * 1.5;
            slider.scrollLeft = startScrollLeft + walk;
        });

        slider.addEventListener("touchend", () => {
            const imageWidth = images[0].offsetWidth + 20;
            currentIndex = Math.round(slider.scrollLeft / imageWidth);
            updateSlider(true);
        });
    });
});
</script>