---
const currentLocale = Astro.currentLocale || 'es';

const translations = {
  es: {
    form: {
      nombre: "Nombre",
      apellido: "Apellido",
      telefono: "Número Telefónico",
      email: "Email",
      mensaje: "Mensaje",
      enviar: "Enviar",
      enviando: "Enviando..."
    },
    contact: {
      titulo: "Contacto Hotel:",
      reservaciones: "Reservaciones:",
      recepcion: "Recepción:"
    },
    alerts: {
      successTitle: "¡Enviado!",
      successText: "Tu mensaje ha sido enviado con éxito.",
      errorTitle: "Error",
      errorText: "No pudimos enviar el mensaje. Intenta de nuevo."
    }
  },
  en: {
    form: {
      nombre: "Name",
      apellido: "Last Name",
      telefono: "Phone Number",
      email: "Email",
      mensaje: "Message",
      enviar: "Send",
      enviando: "Sending..."
    },
    contact: {
      titulo: "Hotel Contact:",
      reservaciones: "Reservations:",
      recepcion: "Front Desk:"
    },
    alerts: {
      successTitle: "Sent!",
      successText: "Your message has been sent successfully.",
      errorTitle: "Error",
      errorText: "We couldn't send the message. Please try again."
    }
  }
};

const t = translations[currentLocale as keyof typeof translations];
---

<section class="contacto-section">
  <div class="container-form">
    <form class="form-contacto">
      <input name="Nombre" placeholder={t.form.nombre} type="text" required/>
      <input name="Apellido"placeholder={t.form.apellido}type="text" required/>
      <input required name="Telefono" placeholder={t.form.telefono} type="number" />
      <input name="Email" placeholder={t.form.email} type="email" required  />
      <textarea name="Mensaje"  placeholder={t.form.mensaje} ></textarea>
      <button type="submit">{t.form.enviar}</button>
    </form>
  </div>

  <div class="container-info">
    <ul class="lista-contacto ">
      <li> <i class="bi bi-geo-alt-fill"></i>Calle Union 184, Cusco, Perú</li>
      <li><i class="bi bi-telephone-fill"></i>{t.contact.reservaciones} +51 987 945 817</li>
      <li><i class="bi bi-telephone-fill"></i>{t.contact.recepcion} +51 997 564 558</li>
      <li class=" contacto-titulo">{t.contact.titulo}</li>
      <li ><i class="bi bi-telephone-fill"></i>(51 - 84) 887-72950</li>
      <li ><i class="bi bi-telephone-fill"></i>(51 - 84) 887-72950</li>
      <li ><i class="bi bi-envelope"></i>reservas@TerraAndinaHotel.com</li>
    </ul>


    <div class="mapouter">
      <div class="gmap_canvas">
        <iframe 
          title="Mapa de ubicación Terra Andina Hotel"
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4808.667528507802!2d-71.9861396240546!3d-13.519555586848554!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x916dd676e83d2897%3A0x908cd5f8e2442658!2sTerra%20Andina%20Hotel!5e1!3m2!1ses-419!2sus!4v1771431350542!5m2!1ses-419!2sus" 
          class="mapa-iframe"
          loading="lazy"
          allowfullscreen="" 
          loading="lazy" 
          >
        </iframe>
      </div>
    </div>
  </div>
</section>


<style>
  .lista-contacto li{
      border-bottom: 1px solid rgb(233, 233, 233);
      font-family: var(--font-family-poppins);
  }
</style>


<script is:inline src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script is:inline define:vars={{ t }}>
  const URL = "https://lost-roxanna-ltasaycoqs-9d45b4eb.koyeb.app/index.php";
  const form = document.querySelector(".form-contacto");
  
  form?.addEventListener("submit", async (e) => {
    e.preventDefault();
    const btn = form.querySelector("button");
    const originalText = btn.innerText;
    btn.innerText = t.form.enviando;
    btn.disabled = true;
    
    const formData = new FormData(form);
    const data = {
      nombres: formData.get("Nombre"),
      apellidos: formData.get("Apellido"),
      telefono: formData.get("Telefono"),
      email: formData.get("Email"),
      mensaje: formData.get("Mensaje"),
    };
    
    try {
      await fetch(URL, {
        method: "POST",
        mode: "no-cors",
        body: JSON.stringify(data),
      });
      
      Swal.fire({
        title: t.alerts.successTitle,
        text: t.alerts.successText,
        icon: "success",
        confirmButtonColor: "#C08E1F"
      });
      
      form.reset();
    } catch (error) {
      Swal.fire({
        title: t.alerts.errorTitle,
        text: t.alerts.errorText,
        icon: "error",
      });
    } finally {
      btn.innerText = originalText;
      btn.disabled = false;
    }
  });
</script>